<div class="game-page">
  <header class="game-header">
    <div>
      <h1>Game</h1>
      <p>Discover profiles and rate with 10-star feedback.</p>
    </div>
    <div class="game-actions">
      <button type="button" class="game-action-mode" [class.mode-pair]="isPairMode" [class.mode-single]="!isPairMode" (click)="togglePairMode()">
        <mat-icon>{{ isPairMode ? 'groups' : 'person' }}</mat-icon>
        <span>{{ isPairMode ? 'Pair mode' : 'Single mode' }}</span>
      </button>
      <button type="button" class="game-action-filter has-badge" (click)="openFilter()" aria-label="Open profile filters">
        <mat-icon>filter_alt</mat-icon>
      </button>
      <button type="button" class="game-action-filter has-badge" (click)="openFilter()" aria-label="Open profile filters">
        <mat-icon>history</mat-icon>
        <span class="history-badge">{{ activeUser.activities.game }}</span>
      </button>
    </div>
  </header>

  <section class="game-layout-single">
    <article class="card-stack game-card-main">
      <div class="card-content">
        <h2>{{ activeCandidate.name }}, {{ activeCandidate.age }}</h2>
        <p>{{ activeCandidate.city }} · {{ activeCandidate.statusText }}</p>
        <p>{{ activeCandidate.headline }}</p>
      </div>
      <div class="card-image-area">
        <span class="card-image-placeholder">{{ candidateInitials }}</span>
      </div>
      <div class="rating-stars">
        <button
          type="button"
          class="star-btn"
          *ngFor="let score of ratingScale"
          [class.filled]="score <= selectedRating"
          (click)="setRating(score)"
          aria-label="Rate {{ score }}"
        >
          ★
        </button>
      </div>
    </article>
  </section>
</div>

<section class="game-popup" *ngIf="localPopup === 'history'">
  <div class="game-popup-backdrop" (click)="closeLocalPopup()"></div>
  <div class="game-popup-panel" (click)="$event.stopPropagation()">
    <header>
      <h2>Profile Filter</h2>
      <button type="button" (click)="closeLocalPopup()">×</button>
    </header>
    <div class="game-popup-body">
      <p>Filters: profession, school, friends in common.</p>
      <p>Mode: single/pair, distance and recent activity.</p>
    </div>
  </div>
</section>
