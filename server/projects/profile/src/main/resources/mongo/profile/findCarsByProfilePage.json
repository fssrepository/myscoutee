[
        {
            "$match": {
                "_id": "?0"
            }
        },
        {
            "$lookup": {
                "from": "cars",
                "localField": "cars.$id",
                "foreignField": "_id",
                "as": "cars"
            }
        },
        {
            "$unwind": "$cars"
        },
        {
            "$group": {
                "_id": "$cars._id",
                "data": {
                    "$first": "$cars"
                }
            }
        },
        {
            "$match": {
                "$expr": {
                    "$and": [
                        { "$eq": ["$data.status", "A"] },
                        {
                            "$gt": [
                                { "$ifNull": ["$data.createdDate", "ISODate()"] },
                                { "$toDate": ":#{#offset[0]}" }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "$sort": {
                "data.createdDate": -1
            }
        },
        {
            "$limit": "?1"
        },
        {
            "$replaceRoot": {
                "newRoot": {
                    "$mergeObjects": [
                        { "car": "$data" },
                        { "offset": ["$data.createdDate"] }
                    ]
                }
            }
        }
    ]
    