[
        {
            "$match": {
                "$expr": {
                    "$and": [
                        { "$eq": ["$group", "?1"] },
                        { "$ne": ["$_id", "?0"] },
                        {
                            "$or": [
                                { "$eq": ["$status", "A"] },
                                { "$eq": ["$status", "F"] },
                                { "$eq": ["$status", "P"] }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "$lookup": {
                "from": "roles",
                "let": { "p_id": "$_id" },
                "pipeline": [
                    {
                        "$match": {
                            "$expr": { "$eq": ["$$p_id", "$profileId"] }
                        }
                    }
                ],
                "as": "role"
            }
        },
        {
            "$unwind": "$role"
        },
        {
            "$match": {
                "$expr": {
                    "$gt": [{ "$ifNull": ["$createdDate", "ISODate()"] }, { "$toDate": ":#{#offset[0]}" }]
                }
            }
        },
        {
            "$sort": {
                "createdDate": -1
            }
        },
        { "$limit": "?2" },
        {
            "$replaceRoot": {
                "newRoot": {
                    "$mergeObjects": [{ "profile": "$$ROOT" }, { "role": "$role.role", "offset": ["$createdDate"] }]
                }
            }
        }
    ]
    