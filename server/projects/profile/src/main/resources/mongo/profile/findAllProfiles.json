[
        {
            "$match": {
                "$expr": {
                    "$lt": [
                        { "$ifNull": ["$createdDate", "ISODate()"] },
                        { "$toDate": ":#{#offset[0]}" }
                    ]
                }
            }
        },
        {
            "$sort": {
                "createdDate": -1
            }
        },
        {
            "$limit": "?0"
        },
        {
            "$replaceRoot": {
                "newRoot": {
                    "$mergeObjects": [
                        { "profile": "$$ROOT" },
                        { "offset": ["$createdDate"] }
                    ]
                }
            }
        }
    ]
    